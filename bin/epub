#!/usr/bin/env ruby

# == Synopsis
#
# epub: run the event publisher
#
# == Usage
#
# epub [OPTION]
#
# -h, --help:
#    show help
#
# -d, --debug:
#    turn on debug logging
#
# -c, --config filename
#    specify a configuration file
#
# -w, --workers directory
#    specify the directory for finding workers

require 'getoptlong'
require 'rdoc/usage'
require File.dirname(__FILE__) + '/../lib/refinery'

options = {}
opts = GetoptLong.new(
  [ '--help', '-h', GetoptLong::NO_ARGUMENT ],
  [ '--debug', '-d', GetoptLong::NO_ARGUMENT ],
  [ '--config', '-c', GetoptLong::REQUIRED_ARGUMENT]
)
opts.each do |opt, arg|
  case opt
  when '--help'
    RDoc::usage
  when '--debug'
    options[:debug] = true
  when '--config'
    options[:config] = arg
  when '--workers'
    options[:workers] = arg
  end
end

Refinery::EventPublisher.new(options).run